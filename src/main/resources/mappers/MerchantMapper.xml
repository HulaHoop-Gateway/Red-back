<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.hulahoop.redback.merchant.model.dao.MerchantMapper">

    <!-- ✅ 전체 가맹점 운영정보 조회 -->
    <select id="selectAllMerchants" resultType="com.hulahoop.redback.merchant.model.dto.MerchantDTO">
        SELECT
            m.merchant_code,
            m.merchant_name,
            m.business_id,
            c.category_name,
            m.registration_date,
            m.termination_date,
            m.contract_status,
            c.category_code
        FROM T_Merchant m
                 LEFT JOIN T_Brand b ON m.brand_code = b.brand_code
                 LEFT JOIN T_Category c ON b.category_code = c.category_code
        ORDER BY m.merchant_code
    </select>

    <!-- ⭐ branch_name(merchant_name) → merchant_code 조회 기능 추가 -->
    <select id="findMerchantCodeByName" resultType="string" parameterType="string">
        SELECT merchant_code
        FROM T_Merchant
        WHERE merchant_name = #{merchantName}
            LIMIT 1
    </select>

</mapper>
